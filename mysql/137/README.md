# No.137

「EC注文管理システム」を考えます。**注文情報を管理する `orders` テーブル**と、**商品情報を管理する `products` テーブル**が存在します。

**要件**
1. 顧客が注文 (`orders` テーブル) を追加すると、**商品の在庫が自動的に減少**する必要があります。
2. 在庫が不足している場合、注文をキャンセルし、**エラーメッセージを出力**する必要があります。
3. これを最適化するために、**ストアドプロシージャ**を作成し、**トリガーからストアドプロシージャを呼び出す構成**にしてください。
4. 並行して発生するトランザクションによる**デッドロックの発生を防ぐ**ために、**最小限のロックをかける**ようにしてください。
