# No.107

カートに複数の商品が入っているときに、在庫の更新と注文履歴の登録を1つのトランザクションで実行します。すべての在庫が十分でない場合にはロールバックします。また、トランザクション中に無駄な行を更新しないように最適化します。

### テーブル設計

**Products テーブル:**

| ProductID | ProductName | Stock |
|-----------|-------------|-------|
| 1         | TV          | 15    |
| 2         | Laptop      | 30    |
| 3         | Headphones  | 50    |

**Orders テーブル:**

| OrderID | ProductID | Quantity | OrderDate  |
|---------|-----------|----------|------------|
