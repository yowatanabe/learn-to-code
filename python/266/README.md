# No.266

## 問題文

**クラスタが全接続になる最初の時刻**

`n` 台のサーバがあり、番号は `0` から `n-1` で表される。

ネットワーク設定変更ログが配列 `logs` として与えられる。

各要素 `logs[i] = [time_i, a_i, b_i]` は、

* 時刻 `time_i` にサーバ `a_i` とサーバ `b_i` の間に**双方向の接続**が張られた

ことを意味する（すでに接続されている場合は変化なしとみなしてよい）。

時刻が進むにつれて接続が増えていき、
**どのサーバからも他の全サーバへ経路が存在する（= グラフが 1 つの連結成分になる）最初の時刻**を求めよ。

* そのような時刻が存在する場合は、その **`time` の最小値**を返す。
* 最後まで連結成分が 1 つにならない場合は `-1` を返す。
* サーバ数 `n` は `1 ≤ n ≤ 10^5`
* ログ数は `0 ≤ len(logs) ≤ 10^5`
* 各 `time_i` は一意とは限らないが、`int` として比較可能な値とする。
* `0 ≤ a_i, b_i < n` かつ `a_i != b_i`

**条件:**

* 期待計算量は **O(L log L)** （`L = len(logs)`。`logs` のソートが支配的）
* Union-Find（Disjoint Set Union）などを用いて実装せよ。

## 実行例

**例1**

```text
入力:
n = 4
logs = [
  [1, 0, 1],
  [3, 1, 2],
  [4, 2, 3]
]

出力:
4

説明:
時刻1: 0-1 が接続 → {0,1}, {2}, {3} （連結成分数 3）
時刻3: 1-2 が接続 → {0,1,2}, {3}   （連結成分数 2）
時刻4: 2-3 が接続 → {0,1,2,3}      （連結成分数 1）
よって最初に全接続になるのは時刻4。
```

**例2**

```text
入力:
n = 4
logs = [
  [5, 0, 1],
  [2, 2, 3],
  [4, 1, 2]
]

出力:
5

説明:
time順に並べると [2,2-3], [4,1-2], [5,0-1]。
時刻2: {2,3}, {0}, {1}
時刻4: {1,2,3}, {0}
時刻5: {0,1,2,3} → ここで全接続。答えは5。
```

**例3**

```text
入力:
n = 3
logs = [
  [1, 0, 1]
]

出力:
-1

説明:
0-1はつながるが、2が孤立したままなので最後まで全接続にならない。
```

**例4**

```text
入力:
n = 1
logs = []
出力:
0

説明:
サーバが1台だけなので最初から全接続とみなせる。0を返すことにする。
```

## 実行結果

```
4
5
-1
0
```
